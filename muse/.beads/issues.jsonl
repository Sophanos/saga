{"id":"muse-2df","title":"Hetzner + Qdrant + Cloudflare Integration","description":"Set up Qdrant vector DB on Hetzner with Cloudflare Tunnel for secure access.\n\nServer: ssh -i ~/.ssh/hetzner_orchestrator root@78.47.165.136\n\nSetup Steps:\n- [ ] SSH into Hetzner, check if Qdrant running: docker ps | grep qdrant\n- [ ] Install Qdrant if needed (Docker with API key)\n- [ ] Create saga_vectors collection (4096 dims, Cosine, HNSW)\n- [ ] Configure UFW firewall rules\n\nCloudflare Tunnel:\n- [ ] Create tunnel: cloudflared tunnel create qdrant-tunnel\n- [ ] Route DNS: qdrant.saga.dev (or similar)\n- [ ] Configure /etc/cloudflared/config.yml\n- [ ] Enable systemd service\n\nTesting (curl):\n- [ ] Health check: curl https://qdrant.domain.com/collections\n- [ ] Collection info: curl .../collections/saga_vectors\n- [ ] Insert test vector\n- [ ] Search test vector\n- [ ] Delete test vector\n\nEnvironment Variables:\n- [ ] QDRANT_URL (Cloudflare tunnel URL)\n- [ ] QDRANT_API_KEY\n- [ ] QDRANT_COLLECTION=saga_vectors\n- [ ] Add to Supabase Edge Function secrets\n\nRef: /Users/mibook/saga/docs/QDRANT_SETUP.md","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T06:02:10.605013+01:00","updated_at":"2025-12-29T06:02:10.605013+01:00"}
{"id":"muse-3nn","title":"Mobile Capture Hub - Implementation Reference","description":"Reference document for Mobile Capture Hub implementation. Focus shifting to web - this captures what was built for mobile foundation.","design":"# Mobile Capture Hub - Implementation Reference\n\n## Overview\nThis document captures what was implemented for the Mobile Capture Hub feature. The focus is shifting to web, so this serves as a reference for the mobile foundation that was built.\n\n---\n\n## Wave 1: Foundation \u0026 Infrastructure (COMPLETED)\n\n### 1. Shared State Foundation\n**File:** `packages/state/src/progressive.ts`\n\nCreated comprehensive Zustand store with:\n- **Writer Archetype:** `architect | gardener | hybrid` with selectors\n- **Milestones Tracking:** word_count, chapter_complete, entity_created goals\n- **UI Visibility State:** Progressive disclosure controls\n- **Captures Inbox State:** Full CRUD for CaptureRecord\n\nKey exports:\n```ts\n// Types\nexport type WriterArchetype, CaptureKind, CaptureStatus, CaptureRecord, Milestone, UIVisibility\n\n// Store\nexport const useProgressiveStore\n\n// Selectors (30+)\nexport const useWriterArchetype, useInboxCaptures, usePendingCaptures,\n  useCapturesByKind, useMilestones, useUIVisibility, useIsFeatureVisible...\n```\n\n### 2. Database Migration\n**File:** `packages/db/src/migrations/010_captures.sql`\n\nTable: `captures`\n- id, project_id, created_by, kind, status, title, content\n- media_url, media_mime_type, payload (jsonb), source\n- created_at, updated_at, processed_at\n\nRLS Policies:\n- SELECT: Projects user owns or is member of\n- INSERT: Own projects or editor role\n- UPDATE: Own captures or editor role\n- DELETE: Own captures or project owner\n\n**File:** `packages/db/src/queries/captures.ts`\n- getCaptures, getCapture, getCapturesByStatus, getCapturesByKind\n- createCapture, updateCapture, updateCaptureStatus, deleteCapture\n- getInboxCaptures, createCaptures, deleteCapturesByProject\n\n### 3. Sync Engine Extension\n**Files Modified:**\n- `packages/sync/src/types.ts` - Added `captures` to SyncTable, ProjectSnapshot, LocalDbAdapter\n- `packages/sync/src/syncEngine.ts` - Bootstrap, realtime, push/apply for captures\n- `packages/sync/src/native/sqliteDb.ts` - SQLite schema + CRUD for captures\n- `packages/sync/src/web/dexieDb.ts` - Dexie v2 upgrade + captures store\n\nLocalDbAdapter new methods:\n```ts\ngetCapture(id: string): Promise\u003cRecord\u003cstring, unknown\u003e | null\u003e;\ngetCaptures(projectId: string): Promise\u003cRecord\u003cstring, unknown\u003e[]\u003e;\nupsertCapture(capture: Record\u003cstring, unknown\u003e): Promise\u003cvoid\u003e;\ndeleteCapture(id: string): Promise\u003cvoid\u003e;\n```\n\n---\n\n## Wave 2: Mobile UI \u0026 Features (COMPLETED)\n\n### 4. Core Capture Types\n**Files:** `packages/core/src/inbox/types.ts`, `packages/core/src/inbox/index.ts`\n\nShared types for web + mobile:\n```ts\nexport type CaptureKind = \"text\" | \"voice\" | \"photo\" | \"flag\" | \"chat_plan\";\nexport type CaptureStatus = \"inbox\" | \"processed\" | \"archived\";\nexport type CaptureSource = \"mobile\" | \"web\";\n\nexport interface CaptureRecord { id, projectId, createdBy, kind, status, ... }\nexport interface VoiceCapturePayload { durationMs, transcription, language, localUri }\nexport interface PhotoCapturePayload { width, height, description, localUri }\nexport interface FlagCapturePayload { documentId, excerpt, paragraphIndex, ... }\nexport interface ChatPlanCapturePayload { conversationId, responseToSave, ... }\n\n// Helpers\ncaptureHasMedia(), captureNeedsProcessing(), getCaptureKindLabel(), getCaptureKindIcon()\n```\n\n### 5. Mobile Sync Integration\n**File:** `apps/mobile/lib/useSyncEngine.ts`\n- Opens expo-sqlite database\n- Creates SQLite adapter\n- Starts/stops SyncEngine on projectId changes\n- Subscribes to isOnline and calls engine.setOnline()\n- Exposes: mutate, queueAi, syncNow\n\n**File:** `apps/mobile/lib/useProjectSelection.ts`\n- Persists last selected projectId to AsyncStorage\n- Restores on app start\n\n**File:** `apps/mobile/app/_layout.tsx`\n- Added SyncProvider component\n- SyncStatusIndicator for visual feedback\n\n### 6. Capture UI Components\n**Files:** `apps/mobile/components/capture/`\n\n| Component | Description |\n|-----------|-------------|\n| CaptureFAB.tsx | Floating action button, animated, bottom-right |\n| CaptureModal.tsx | Bottom sheet with capture type options |\n| TextCaptureSheet.tsx | Quick text entry with title/content |\n| index.ts | Barrel exports |\n\n**File:** `apps/mobile/hooks/useCapture.ts`\n```ts\nexport function useCapture(): {\n  createTextCapture(input: { title?: string; content: string }): Promise\u003cstring\u003e;\n  createVoiceCapture(draft: { localUri, mimeType, durationMs? }): Promise\u003cstring\u003e;\n  createPhotoCapture(draft: { localUri, mimeType, width?, height? }): Promise\u003cstring\u003e;\n  createFlagCapture(draft: { documentId, excerpt, note? }): Promise\u003cstring\u003e;\n  isCreating: boolean;\n  error: string | null;\n}\n```\n\n---\n\n## NOT YET IMPLEMENTED (Mobile-specific)\n\n### Voice/Photo Capture\n- VoiceRecorder.tsx - expo-av recording\n- PhotoCapture.tsx - expo-image-picker or expo-camera\n- useCaptureProcessor.ts - background upload + AI processing\n\n### Edge Functions\n- ai-transcribe - Whisper transcription\n- ai-describe-image - Vision model description\n- ai-agent non-streaming mode for mobile\n\n### Mobile Navigation\n- (tabs)/_layout.tsx - Tab-based navigation\n- reader/[documentId].tsx - Manuscript viewing + highlighting\n\n### Mobile Chat\n- MobileChatBar.tsx - Bottom sheet chat\n- useMobileChat.ts - Non-streaming chat hook\n\n### World Browser\n- SemanticSearchBar.tsx - Entity search\n- RelationshipMiniGraph.tsx - SVG mini graph\n\n---\n\n## WEB INTEGRATION POINTS\n\nThe foundation is ready for web to consume:\n\n### From @mythos/state\n```ts\nimport { \n  useProgressiveStore,\n  useInboxCaptures,\n  usePendingCaptures,\n  useWriterArchetype,\n  useMilestones,\n  useUIVisibility,\n} from \"@mythos/state\";\n```\n\n### From @mythos/core\n```ts\nimport {\n  CaptureRecord,\n  CaptureKind,\n  getCaptureKindLabel,\n  getCaptureKindIcon,\n} from \"@mythos/core\";\n```\n\n### From @mythos/db\n```ts\nimport {\n  getCaptures,\n  getInboxCaptures,\n  updateCaptureStatus,\n} from \"@mythos/db\";\n```\n\n### Web Features to Build\n1. **Inbox Panel** - Display mobile captures as nudges\n2. **Capture Processing UI** - Review transcriptions, descriptions\n3. **Progressive Disclosure** - Use milestones + archetype for UX\n4. **Genesis Wizard** - Use progressive store for onboarding state\n","acceptance_criteria":"## Mobile Foundation (DONE)\n- [x] Captures table migration with RLS policies\n- [x] Sync engine extended for captures (types, adapters, engine)\n- [x] Progressive state store with archetype, milestones, UI visibility\n- [x] Core inbox types shared between web/mobile\n- [x] Mobile sync hook (useSyncEngine)\n- [x] Mobile project selection persistence\n- [x] CaptureFAB, CaptureModal, TextCaptureSheet components\n- [x] useCapture hook for creating captures\n\n## Mobile Remaining (DEFERRED - focus on web)\n- [ ] VoiceRecorder component (expo-av)\n- [ ] PhotoCapture component (expo-image-picker)\n- [ ] useCaptureProcessor for background AI processing\n- [ ] ai-transcribe edge function\n- [ ] ai-describe-image edge function\n- [ ] ai-agent non-streaming mode\n- [ ] Tabs navigation layout\n- [ ] Reader with entity highlighting\n- [ ] Mobile chat bar\n\n## Web Integration (NEXT PRIORITY)\n- [ ] Inbox panel showing mobile captures as nudges\n- [ ] Capture processing/review UI\n- [ ] Progressive disclosure using milestones\n- [ ] Genesis wizard using progressive store\n- [ ] Template picker for writer archetypes","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T07:20:53.413601+01:00","updated_at":"2025-12-29T07:25:41.261683+01:00","labels":["captures","mobile","reference","sync"]}
{"id":"muse-4d5","title":"Epic: AI Image Generation from Entity Data","description":"Writers can generate character portraits, location art, item icons from entity data. Covers:\n- Character portraits from VisualDescription fields\n- Location/world art (mountains, space, cities, LOTR-style landscapes)\n- Item/artifact icons\n- World-specific elements (magic systems, factions)\n- Integration with chat, chapters, world view, character profiles\n\nSubtasks:\n1. Supabase Storage bucket setup\n2. project_assets DB table migration\n3. ai-generate-image edge function (Replicate/FAL.ai)\n4. Entity portrait generation UI\n5. Location/world art generation\n6. Asset library component\n7. Chat integration (generate from conversation)\n8. Chapter illustration insertion","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T05:53:58.570419+01:00","updated_at":"2025-12-29T05:53:58.570419+01:00"}
{"id":"muse-4mj","title":"Epic: Visual Consistency \u0026 Control System","description":"Ensure generated images maintain consistency across the project. Leverages existing vector embeddings and AI analysis.\n\nKey Features:\n- Reference image upload and style locking\n- Character consistency via IP-Adapter/ControlNet\n- Scene illustration from prose context\n- Style presets per project (manga, realistic, painterly, etc.)\n- Visual embedding storage (link images to entity vectors)\n- AI analysis of generated images for consistency checking\n- Negative prompt learning from rejected generations\n\nIntegration Points:\n- World Graph visual style inheritance\n- Entity relationship affects scene composition\n- RAG retrieval includes visual context\n- Linter checks visual consistency (eye color, outfit, etc.)\n\nDepends on: muse-4d5 (AI Image Generation)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T05:54:08.322282+01:00","updated_at":"2025-12-29T05:54:08.322282+01:00"}
{"id":"muse-5kn","title":"Collaboration Feature - Multi-user project sharing","description":"## Overview\nMulti-user collaboration for Mythos projects.\n\n## Implemented Components\n- **Project Members**: RLS-protected member roles (owner/editor/viewer)\n- **Invitations**: Email-based invite flow with token acceptance\n- **Activity Log**: Auto-logged entity/document/relationship changes\n- **Realtime Presence**: Live collaborator awareness via Supabase Realtime\n- **UI Components**: CollaboratorsBar, InviteMemberModal, ActivityFeed, InviteAcceptPage\n\n## Environment Variables Required\n```\nRESEND_API_KEY=your-resend-api-key\nINVITE_FROM_EMAIL=Mythos \u003cnoreply@mythos.dev\u003e\nAPP_URL=http://localhost:5173\n```\n\n## Key Files\n- `supabase/functions/invite-member/` - Email invitation edge function\n- `packages/db/src/migrations/007_collaboration.sql` - DB schema\n- `packages/db/src/queries/project-*.ts` - Member/invitation queries\n- `apps/web/src/hooks/useCollaboration.ts` - Realtime presence hook\n- `apps/web/src/components/collaboration/` - UI components\n\n## Remaining Work\n- [ ] Real-time cursors/selections in editor\n- [ ] Conflict resolution for concurrent edits\n- [ ] Activity notifications (in-app + email digest)\n- [ ] Role management UI (change/remove members)\n- [ ] Project transfer ownership","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-29T16:40:13.347758+01:00","updated_at":"2025-12-29T16:40:13.347758+01:00","labels":["collaboration","role-management-complete","v1"]}
{"id":"muse-7r3","title":"Onboarding flow integration","description":"Welcome screen, user preferences, first project setup wizard","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T02:34:18.836257+01:00","updated_at":"2025-12-29T02:34:18.836257+01:00","dependencies":[{"issue_id":"muse-7r3","depends_on_id":"muse-xpl","type":"parent-child","created_at":"2025-12-29T02:34:42.29269+01:00","created_by":"daemon"},{"issue_id":"muse-7r3","depends_on_id":"muse-x3g","type":"blocks","created_at":"2025-12-29T07:30:36.777156+01:00","created_by":"daemon"}],"comments":[{"id":1,"issue_id":"muse-7r3","author":"mibook","text":"Template Picker Modal implemented (cb6c1c8):\n\n**Components Created:**\n- TemplatePickerModal/ - Multi-step modal container\n- StartOptions.tsx - 3 paths: AI / Browse Templates / Start Blank\n- TemplateGrid.tsx - Category tabs + search (13 templates)\n- TemplateCard.tsx - Template preview card\n- CreateProjectForm.tsx - Name + Gardener/Architect toggle\n\n**Entry Points:**\n- ProjectSelectorScreen 'New Project' button\n- Header project dropdown (New Project, Switch Project)\n- Command palette (Cmd+K → 'New Project')\n- Global shortcut Cmd+N\n\n**Infrastructure:**\n- stores/navigation.ts - Cross-component project switching\n- Updated stores/index.ts with templatePicker modal type\n\n**Remaining:**\n- AI Template Builder (mini-chat) - placeholder exists\n- Welcome screen for first-time users\n- User preferences collection\n- Adaptive onboarding based on entry flow","created_at":"2025-12-29T14:28:47Z"}]}
{"id":"muse-7r3.1","title":"AI Template Builder - Complete","description":"Implemented AI Template Builder in TemplatePickerModal. Commit: 0fe67b1","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T16:05:33.824619+01:00","updated_at":"2025-12-29T16:05:52.959857+01:00","closed_at":"2025-12-29T16:05:52.959857+01:00","dependencies":[{"issue_id":"muse-7r3.1","depends_on_id":"muse-7r3","type":"parent-child","created_at":"2025-12-29T16:05:33.825695+01:00","created_by":"daemon"}]}
{"id":"muse-7r3.2","title":"Notion-style Try Before Signup Flow","description":"Implement anonymous session with context preservation on auth. Try Import/Chat without signup, merge to real account on auth.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-29T16:06:00.96123+01:00","updated_at":"2025-12-29T16:06:00.96123+01:00","dependencies":[{"issue_id":"muse-7r3.2","depends_on_id":"muse-7r3","type":"parent-child","created_at":"2025-12-29T16:06:00.961713+01:00","created_by":"daemon"}]}
{"id":"muse-8lj","title":"Connect chatbar to signup/app flow","description":"When user submits text/files in hero chatbar, redirect to signup or app with content preserved","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T02:34:18.986238+01:00","updated_at":"2025-12-29T02:34:18.986238+01:00","dependencies":[{"issue_id":"muse-8lj","depends_on_id":"muse-xpl","type":"parent-child","created_at":"2025-12-29T02:34:42.371164+01:00","created_by":"daemon"},{"issue_id":"muse-8lj","depends_on_id":"muse-dbv","type":"blocks","created_at":"2025-12-29T02:34:50.046164+01:00","created_by":"daemon"}]}
{"id":"muse-921","title":"Epic: Video Generation \u0026 Interactive World","description":"Abstract video generation and interactive world exploration for gaming/film studios.\n\nVideo Generation:\n- Scene-to-video from prose (RunwayML/Pika)\n- Character animation clips\n- Cinematic storyboard export\n- Trailer/pitch video compilation\n\nInteractive World:\n- Explorable 2D/3D world from World Graph\n- Location navigation with generated visuals\n- Character encounters at locations\n- Timeline scrubbing (see world at different story points)\n\nExport Formats:\n- Visual Novel skeleton (Ren'Py compatible)\n- Storyboard PDF (manga panel layout)\n- Game asset pack (sprites, backgrounds)\n- Film pitch deck with cinematics\n\nTarget Users:\n- Gaming studios (prototype cinematics)\n- Manga artists (storyboard generation)\n- Film/TV writers (pitch visualization)\n- Visual novel creators\n\nDepends on: muse-4mj (Visual Consistency)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T05:54:20.339073+01:00","updated_at":"2025-12-29T05:54:20.339073+01:00"}
{"id":"muse-9r6","title":"Mobile: Add story import feature","description":"Add import functionality to mobile app matching web implementation:\n- Create ImportModal component for React Native\n- Add file picker using expo-document-picker\n- Reuse import service from web (services/import)\n- Support Markdown, DOCX, EPUB, plain text formats\n- Add Import button to editor screen header\n- Progress tracking with cancel support","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T02:55:52.337048+01:00","updated_at":"2025-12-29T02:55:52.337048+01:00","dependencies":[{"issue_id":"muse-9r6","depends_on_id":"muse-9zi","type":"blocks","created_at":"2025-12-29T02:57:17.307531+01:00","created_by":"daemon"}]}
{"id":"muse-9zi","title":"Mobile: complete screen implementations","description":"Finish Projects, World, Settings screens with full functionality","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-29T02:34:19.054099+01:00","updated_at":"2025-12-29T02:34:19.054099+01:00","dependencies":[{"issue_id":"muse-9zi","depends_on_id":"muse-xpl","type":"parent-child","created_at":"2025-12-29T02:34:42.423178+01:00","created_by":"daemon"}]}
{"id":"muse-dbv","title":"Auth screens for website","description":"Auth screens for website - UI DONE\n\nRemaining:\n- [ ] Test auth flow end-to-end\n- [ ] Supabase Auth configuration\n- [ ] Apple Sign-In setup (App Store Connect + Supabase)\n- [ ] Google Sign-In setup (Google Cloud Console + Supabase)\n- [ ] Integration testing across providers","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-29T02:34:18.917461+01:00","updated_at":"2025-12-29T05:59:30.596193+01:00","dependencies":[{"issue_id":"muse-dbv","depends_on_id":"muse-xpl","type":"parent-child","created_at":"2025-12-29T02:34:42.331848+01:00","created_by":"daemon"}]}
{"id":"muse-kkn","title":"Progressive Disclosure Polish","description":"Polish items for progressive disclosure system:\n- Tutorial overlays (coach marks for first-time features)\n- Persist 'never ask' preferences to Supabase  \n- Wire ConsistencyLinter agent to UI (currently mock data)\n- Phase progression analytics (track unlock rates)\n- Customizable unlock thresholds in settings\n\nSee ARCHITECTURE_REVIEW.md section 5.5","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T09:02:31.343255+01:00","updated_at":"2025-12-29T09:02:31.343255+01:00","dependencies":[{"issue_id":"muse-kkn","depends_on_id":"muse-x3g","type":"blocks","created_at":"2025-12-29T09:03:32.078634+01:00","created_by":"daemon"}]}
{"id":"muse-mg3","title":"Testing on real devices","description":"Test mobile app on iOS/Android devices, website on various browsers","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-29T02:34:19.119262+01:00","updated_at":"2025-12-29T02:34:19.119262+01:00","dependencies":[{"issue_id":"muse-mg3","depends_on_id":"muse-xpl","type":"parent-child","created_at":"2025-12-29T02:34:42.463046+01:00","created_by":"daemon"},{"issue_id":"muse-mg3","depends_on_id":"muse-7r3","type":"blocks","created_at":"2025-12-29T02:34:50.085225+01:00","created_by":"daemon"}]}
{"id":"muse-utc","title":"Implement clarity_check AI tool","description":"Add a new Saga tool **clarity_check** that finds word/phrase-level clarity problems:\n\n## Features Implemented\n- **5 Issue Categories**: ambiguous_pronoun, unclear_antecedent, cliche, filler_word, dangling_modifier\n- **Readability Metrics**: Flesch-Kincaid Grade, Reading Ease, avg words/sentence, word count\n- **Position-based Decorations**: Uses character offsets for accurate highlighting of repeated words\n- **Unified Issue Display**: Clarity issues appear alongside coach issues in the Style panel\n- **Quick Action + Command Palette**: Both accessible via sidebar and ⌘K\n\n## Files Created\n- packages/prompts/src/clarity.ts\n- supabase/functions/_shared/prompts/clarity.ts\n- supabase/functions/_shared/tools/clarity-check.ts\n- apps/web/src/tools/executors/clarityCheck.ts\n\n## Files Modified\n- packages/core/src/analysis/types.ts\n- packages/agent-protocol/src/index.ts\n- supabase/functions/_shared/tools/index.ts\n- supabase/functions/_shared/saga/executors.ts\n- supabase/functions/ai-saga/index.ts\n- apps/web/src/services/ai/sagaClient.ts\n- apps/web/src/tools/registry.ts\n- apps/web/src/tools/types.ts\n- apps/web/src/stores/analysis.ts\n- apps/web/src/components/console/StyleIssuesList.tsx\n- apps/web/src/components/console/StyleFixPreviewModal.tsx\n- apps/web/src/components/console/CoachView.tsx\n- apps/web/src/components/console/AISidebar/QuickActions.tsx\n- apps/web/src/commands/ai-commands.ts\n- packages/editor/src/extensions/style-decoration.ts\n- apps/web/src/styles/globals.css","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T17:12:20.029148+01:00","updated_at":"2025-12-29T17:13:25.084001+01:00","closed_at":"2025-12-29T17:13:25.084001+01:00"}
{"id":"muse-x3g","title":"Progressive Structure System - Implementation Complete","description":"Implemented Progressive Structure System for Mythos IDE. Provides two entry points for project creation (Architect vs Gardener modes) with progressive feature disclosure for Gardener mode.\n\n## Key Components\n\n### 1. Extended Progressive Store (`packages/state/src/progressive.ts`)\n- Per-project progressive state with phases 1-4\n- Nudge system: EntityDiscoveryNudge, ConsistencyChoiceNudge, FeatureUnlockNudge\n- UI module unlock tracking (UIModuleId type)\n- Actions: setActiveProject, ensureProject, setCreationMode, setPhase, unlockModule, showNudge, dismissNudge\n- Selectors: useProgressivePanelVisibility, useIsGardenerMode, useActiveNudge, useActivePhase\n\n### 2. Dual Entry Points (`apps/web/src/components/modals/ProjectCreateModal.tsx`)\n- \"Start Writing\" (Gardener) - Phase 1, editor only\n- \"Build Your World\" (Architect) - Phase 4, all features\n- Initializes progressive state on project creation\n\n### 3. Progressive State Initialization (`apps/web/src/hooks/useProjectLoader.ts`)\n- Initializes progressive state when project loads\n- Legacy projects default to architect mode (full features)\n\n### 4. UI Panel Gating (`apps/web/src/components/Layout.tsx`)\n- Manifest and Console conditionally render via useProgressivePanelVisibility()\n- Gardener mode hides panels until unlocked\n- Canvas adapts size based on visible panels\n\n### 5. Progressive Components (`apps/web/src/components/progressive/`)\n- ProgressiveNudge.tsx - Subtle notifications for entity discovery, consistency, feature unlocks\n- ProgressiveStructureController.tsx - Phase transitions, word count tracking, paste detection\n- index.ts - Exports\n\n### 6. Entity Detection Updates (`apps/web/src/hooks/useEntityDetection.ts`)\n- Added autoOpenModal option (can disable for nudge flow)\n- Added onDetectionComplete callback\n- Stores pending entities in progressive store\n\n### 7. Consistency Choice Modal (`apps/web/src/components/modals/ConsistencyChoiceModal.tsx`)\n- Canon choice resolution for consistency issues\n- Part of Phase 3 progressive disclosure\n\n## Phase Behavior Matrix\n| Mode | Phase | Visible Panels |\n|------|-------|----------------|\n| Gardener | 1 | Editor only |\n| Gardener | 2 | Editor + Manifest (after entity detection at ~500 words) |\n| Gardener | 3 | Editor + Manifest + Console (after first consistency issue) |\n| Gardener | 4 | All panels |\n| Architect | 4 | All panels from start |\n\n## Phase Transition Triggers\n- Phase 1→2: Word count threshold (~500 words) OR substantial paste\n- Phase 2→3: First consistency/contradiction detected by linter\n- Phase 3→4: User resolves consistency issue\n\n## Integration Points\n- Genesis Wizard can use progressive store for onboarding\n- Milestones can trigger feature unlock nudges\n- Mobile capture hub shares progressive state","acceptance_criteria":"## Completed\n- [x] Per-project progressive state in Zustand store\n- [x] Phase types (1-4) and UIModuleId enum\n- [x] Nudge system (entity_discovery, consistency_choice, feature_unlock)\n- [x] Dual entry points in ProjectCreateModal (Gardener/Architect)\n- [x] Progressive state initialization on project load\n- [x] UI panel gating in Layout.tsx\n- [x] ProgressiveNudge component with dismiss/snooze/never-ask\n- [x] ProgressiveStructureController for phase transitions\n- [x] useEntityDetection nudge mode support\n- [x] ConsistencyChoiceModal for Phase 3\n- [x] TypeScript compiles cleanly (web + state packages)\n\n## Future Enhancements\n- [ ] Persistence of progressive state to localStorage/DB\n- [ ] Writing time tracking with idle detection\n- [ ] Feature unlock suggestions based on usage patterns\n- [ ] Timeline/World Graph progressive unlocks\n- [ ] Integration with linter for Phase 2→3 trigger","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-29T07:30:16.062167+01:00","updated_at":"2025-12-29T07:30:29.64396+01:00","closed_at":"2025-12-29T07:30:29.64396+01:00","labels":["architect","gardener","progressive","state","ui"]}
{"id":"muse-xpl","title":"Platform Launch Tasks","description":"Epic for website and mobile app launch tasks","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T02:34:09.138056+01:00","updated_at":"2025-12-29T02:34:09.138056+01:00"}
